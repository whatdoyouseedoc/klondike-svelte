import{r as le,s as H,n as se,x as Ke,o as ze}from"../chunks/scheduler.CLOVJmCQ.js";import{f as V,t as E,S as U,i as X,e as $,s as q,g as ue,c as j,a as M,d as D,j as L,h as de,o as C,p as ae,y as Y,b as B,k as T,z as A,A as ye,B as re,l as ce,q as Z,n as G,u as J,v as N,w as Q,x as R,C as Be,D as Je,m as ie}from"../chunks/index.D7hiiBSS.js";import{w as Ne}from"../chunks/index.D1cIUrcn.js";const Qe=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function F(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function fe(t,e){V(t,1,1,()=>{e.delete(t.key)})}function pe(t,e,a,n,i,s,r,d,k,o,l,f){let b=t.length,v=s.length,w=b;const m={};for(;w--;)m[t[w].key]=w;const _=[],y=new Map,I=new Map,p=[];for(w=v;w--;){const g=f(i,s,w),h=a(g);let O=r.get(h);O?n&&p.push(()=>O.p(g,e)):(O=o(h,g),O.c()),y.set(h,_[w]=O),h in m&&I.set(h,Math.abs(w-m[h]))}const u=new Set,c=new Set;function S(g){E(g,1),g.m(d,l),r.set(g.key,g),l=g.first,v--}for(;b&&v;){const g=_[v-1],h=t[b-1],O=g.key,K=h.key;g===h?(l=g.first,b--,v--):y.has(K)?!r.has(O)||u.has(O)?S(g):c.has(K)?b--:I.get(O)>I.get(K)?(c.add(O),S(g)):(u.add(K),b--):(k(h,r),b--)}for(;b--;){const g=t[b];y.has(g.key)||k(g,r)}for(;v;)S(_[v-1]);return le(p),_}const Re=!0,mt=Object.freeze(Object.defineProperty({__proto__:null,prerender:Re},Symbol.toStringTag,{value:"Module"})),qe=[{suit:"spade",rank:"A",id:"s-A",isOpen:!1},{suit:"spade",rank:"2",id:"s-2",isOpen:!1},{suit:"spade",rank:"3",id:"s-3",isOpen:!1},{suit:"spade",rank:"4",id:"s-4",isOpen:!1},{suit:"spade",rank:"5",id:"s-5",isOpen:!1},{suit:"spade",rank:"6",id:"s-6",isOpen:!1},{suit:"spade",rank:"7",id:"s-7",isOpen:!1},{suit:"spade",rank:"8",id:"s-8",isOpen:!1},{suit:"spade",rank:"9",id:"s-9",isOpen:!1},{suit:"spade",rank:"10",id:"s-10",isOpen:!1},{suit:"spade",rank:"J",id:"s-J",isOpen:!1},{suit:"spade",rank:"Q",id:"s-Q",isOpen:!1},{suit:"spade",rank:"K",id:"s-K",isOpen:!1},{suit:"heart",rank:"A",id:"h-A",isOpen:!1},{suit:"heart",rank:"2",id:"h-2",isOpen:!1},{suit:"heart",rank:"3",id:"h-3",isOpen:!1},{suit:"heart",rank:"4",id:"h-4",isOpen:!1},{suit:"heart",rank:"5",id:"h-5",isOpen:!1},{suit:"heart",rank:"6",id:"h-6",isOpen:!1},{suit:"heart",rank:"7",id:"h-7",isOpen:!1},{suit:"heart",rank:"8",id:"h-8",isOpen:!1},{suit:"heart",rank:"9",id:"h-9",isOpen:!1},{suit:"heart",rank:"10",id:"h-10",isOpen:!1},{suit:"heart",rank:"J",id:"h-J",isOpen:!1},{suit:"heart",rank:"Q",id:"h-Q",isOpen:!1},{suit:"heart",rank:"K",id:"h-K",isOpen:!1},{suit:"club",rank:"A",id:"c-A",isOpen:!1},{suit:"club",rank:"2",id:"c-2",isOpen:!1},{suit:"club",rank:"3",id:"c-3",isOpen:!1},{suit:"club",rank:"4",id:"c-4",isOpen:!1},{suit:"club",rank:"5",id:"c-5",isOpen:!1},{suit:"club",rank:"6",id:"c-6",isOpen:!1},{suit:"club",rank:"7",id:"c-7",isOpen:!1},{suit:"club",rank:"8",id:"c-8",isOpen:!1},{suit:"club",rank:"9",id:"c-9",isOpen:!1},{suit:"club",rank:"10",id:"c-10",isOpen:!1},{suit:"club",rank:"J",id:"c-J",isOpen:!1},{suit:"club",rank:"Q",id:"c-Q",isOpen:!1},{suit:"club",rank:"K",id:"c-K",isOpen:!1},{suit:"diamond",rank:"A",id:"d-A",isOpen:!1},{suit:"diamond",rank:"2",id:"d-2",isOpen:!1},{suit:"diamond",rank:"3",id:"d-3",isOpen:!1},{suit:"diamond",rank:"4",id:"d-4",isOpen:!1},{suit:"diamond",rank:"5",id:"d-5",isOpen:!1},{suit:"diamond",rank:"6",id:"d-6",isOpen:!1},{suit:"diamond",rank:"7",id:"d-7",isOpen:!1},{suit:"diamond",rank:"8",id:"d-8",isOpen:!1},{suit:"diamond",rank:"9",id:"d-9",isOpen:!1},{suit:"diamond",rank:"10",id:"d-10",isOpen:!1},{suit:"diamond",rank:"J",id:"d-J",isOpen:!1},{suit:"diamond",rank:"Q",id:"d-Q",isOpen:!1},{suit:"diamond",rank:"K",id:"d-K",isOpen:!1}],Le={"pile-1":[],"pile-2":[],"pile-3":[],"pile-4":[],"pile-5":[],"pile-6":[],"pile-7":[],talon:[],"foundation-1":[],"foundation-2":[],"foundation-3":[],"foundation-4":[]},he=400,te=Ne(null);function ee(t,e){return Math.floor(Math.random()*(e-t))+t}function Fe(t){return t.sort(()=>Math.random()-.5)}function Se(t){return t.suit==="heart"||t.suit==="diamond"?"red":"black"}function z(t){switch(t.rank){case"A":return 1;case"2":return 2;case"3":return 3;case"4":return 4;case"5":return 5;case"6":return 6;case"7":return 7;case"8":return 8;case"9":return 9;case"10":return 10;case"J":return 11;case"Q":return 12;case"K":return 13}}function W(t,e,a){const i=a[e].at(-1);return e.includes("foundation")?!i&&t.rank==="A"?!0:!i&&t.rank!=="A"?!1:i.suit===t.suit&&z(i)===z(t)-1:!i&&t.rank==="K"?!0:!i&&t.rank!=="K"?!1:Se(i)!==Se(t)&&z(i)===z(t)+1}function me(t){return t.split("--").at(1)}function _e(t){const e="rgba(242, 38, 19, 1)";t.style.boxShadow=`0 0 18px 8px ${e}`}function x(t){t!=null&&t.style&&(t.style.boxShadow="none")}function Pe(t,e){const a=t.getBoundingClientRect(),n=e.getBoundingClientRect(),i=parseInt(getComputedStyle(e).getPropertyValue("padding-top")),s=parseInt(getComputedStyle(e).getPropertyValue("padding-left")),r=parseInt(getComputedStyle(e).getPropertyValue("border-width"));return{x:n.left+s+r-a.left,y:n.top+i+r-a.top}}async function ge(t,e){return new Promise(a=>{const n=Pe(t,e);t.style.transition=`transform ${he/1e3}s`,t.style.transform=`translate(${n.x}px, ${n.y}px)`,setTimeout(()=>{a("done")},he)})}function be(t){let e,a;return e=new oe({props:{updateState:t[3],openCard:t[4],state:t[0],placeId:t[1],cardIndex:t[7]}}),{c(){J(e.$$.fragment)},l(n){N(e.$$.fragment,n)},m(n,i){Q(e,n,i),a=!0},p(n,i){const s={};i&8&&(s.updateState=n[3]),i&16&&(s.openCard=n[4]),i&1&&(s.state=n[0]),i&2&&(s.placeId=n[1]),i&128&&(s.cardIndex=n[7]),e.$set(s)},i(n){a||(E(e.$$.fragment,n),a=!0)},o(n){V(e.$$.fragment,n),a=!1},d(n){R(e,n)}}}function He(t){let e,a,n,i,s,r,d,k=t[5].rank+"",o,l,f,b,v,w,m,_,y=t[1]!=="talon"&&!t[1].includes("foundation")&&t[6][t[7]],I,p,u,c,S,g=y&&be(t);return{c(){e=$("div"),a=$("div"),n=$("div"),i=q(),s=$("div"),r=$("div"),d=$("div"),o=ue(k),l=q(),f=$("div"),b=ue(t[8]),v=q(),w=$("div"),m=ue(t[8]),_=q(),g&&g.c(),this.h()},l(h){e=j(h,"DIV",{id:!0,class:!0,draggable:!0});var O=M(e);a=j(O,"DIV",{class:!0});var K=M(a);n=j(K,"DIV",{class:!0}),M(n).forEach(D),i=L(K),s=j(K,"DIV",{class:!0});var P=M(s);r=j(P,"DIV",{class:!0,style:!0});var ne=M(r);d=j(ne,"DIV",{class:!0});var ke=M(d);o=de(ke,k),ke.forEach(D),l=L(ne),f=j(ne,"DIV",{class:!0});var ve=M(f);b=de(ve,t[8]),ve.forEach(D),ne.forEach(D),v=L(P),w=j(P,"DIV",{class:!0,style:!0});var Oe=M(w);m=de(Oe,t[8]),Oe.forEach(D),P.forEach(D),K.forEach(D),_=L(O),g&&g.l(O),O.forEach(D),this.h()},h(){C(n,"class","card-back svelte-1tr5jno"),C(d,"class","svelte-1tr5jno"),C(f,"class","svelte-1tr5jno"),C(r,"class","card-rank-corner svelte-1tr5jno"),ae(r,"color",t[9]),C(w,"class","card-rank-center svelte-1tr5jno"),ae(w,"color",t[9]),C(s,"class","card-face svelte-1tr5jno"),C(a,"class","card svelte-1tr5jno"),Y(a,"closed",!t[5].isOpen),C(e,"id",I=`dz--${t[1]}--${t[2]}--${t[5].id}`),C(e,"class","dropzone svelte-1tr5jno"),C(e,"draggable",p=t[5].isOpen),Y(e,"foundation-pile",t[1].includes("foundation"))},m(h,O){B(h,e,O),T(e,a),T(a,n),T(a,i),T(a,s),T(s,r),T(r,d),T(d,o),T(r,l),T(r,f),T(f,b),T(s,v),T(s,w),T(w,m),T(e,_),g&&g.m(e,null),u=!0,c||(S=[A(a,"click",t[14]),A(e,"dragstart",ye(t[10])),A(e,"dragover",re(t[11])),A(e,"dragleave",t[12]),A(e,"drop",t[13]),A(e,"dblclick",ye(t[15]))],c=!0)},p(h,[O]){(!u||O&32)&&k!==(k=h[5].rank+"")&&ce(o,k),(!u||O&256)&&ce(b,h[8]),(!u||O&512)&&ae(r,"color",h[9]),(!u||O&256)&&ce(m,h[8]),(!u||O&512)&&ae(w,"color",h[9]),(!u||O&32)&&Y(a,"closed",!h[5].isOpen),O&194&&(y=h[1]!=="talon"&&!h[1].includes("foundation")&&h[6][h[7]]),y?g?(g.p(h,O),O&194&&E(g,1)):(g=be(h),g.c(),E(g,1),g.m(e,null)):g&&(Z(),V(g,1,1,()=>{g=null}),G()),(!u||O&38&&I!==(I=`dz--${h[1]}--${h[2]}--${h[5].id}`))&&C(e,"id",I),(!u||O&32&&p!==(p=h[5].isOpen))&&C(e,"draggable",p),(!u||O&2)&&Y(e,"foundation-pile",h[1].includes("foundation"))},i(h){u||(E(g),u=!0)},o(h){V(g),u=!1},d(h){h&&D(e),g&&g.d(),c=!1,le(S)}}}function Ue(t,e,a){let n,i,s,r,d,{state:k}=e,{placeId:o}=e,{cardIndex:l}=e,{updateState:f}=e,{openCard:b}=e,v;te.subscribe(c=>{v=c});function w(){return n[s]}function m(c){var g;const S={placeId:o,cardIndex:l,cardId:i.id,card:i};te.set(i),(g=c.dataTransfer)==null||g.setData("text/plain",JSON.stringify(S))}function _(c){if(w()||!W(v,o,k))return;const S=c.target.closest(".card");_e(S)}function y(c){const S=c.target.closest(".card");x(S)}function I(c){var P;if(w()||!W(v,o,k))return;const S=c.target.closest(".card");x(S);const g=(P=c.dataTransfer)==null?void 0:P.getData("text/plain"),h=JSON.parse(g),O=c.target.closest(".dropzone"),K=me(O==null?void 0:O.id);f(K,h.placeId,h.cardIndex),te.set(null)}function p(){return b(o,l)}async function u(c){if(!(o!=="talon"&&w()||!i.isOpen||o.includes("foundation")))for(const S of["foundation-1","foundation-2","foundation-3","foundation-4"]){const g=k[S];if(g.length===0){if(z(i)===1){const h=c.target.closest(".card"),O=document.getElementById(`foundation--${S}`);await ge(h,O),f(S,o,l);return}}else{const h=g.at(-1);if(h.suit===i.suit&&z(h)===z(i)-1){const O=c.target.closest(".card"),K=document.getElementById(`foundation--${S}`);await ge(O,K),f(S,o,l);return}}}}return t.$$set=c=>{"state"in c&&a(0,k=c.state),"placeId"in c&&a(1,o=c.placeId),"cardIndex"in c&&a(2,l=c.cardIndex),"updateState"in c&&a(3,f=c.updateState),"openCard"in c&&a(4,b=c.openCard)},t.$$.update=()=>{t.$$.dirty&3&&a(6,n=k[o]),t.$$.dirty&68&&a(5,i=n[l]),t.$$.dirty&4&&a(7,s=l+1),t.$$.dirty&32&&a(9,r=i.suit==="spade"||i.suit==="club"?"black":"red"),t.$$.dirty&32&&a(8,d=i.suit==="spade"?"♠":i.suit==="heart"?"♥":i.suit==="club"?"♣":"♦")},[k,o,l,f,b,i,n,s,d,r,m,_,y,I,p,u]}class oe extends U{constructor(e){super(),X(this,e,Ue,He,H,{state:0,placeId:1,cardIndex:2,updateState:3,openCard:4})}}function Ie(t){let e,a;return e=new oe({props:{updateState:t[2],openCard:t[3],state:t[0],placeId:t[1],cardIndex:0}}),{c(){J(e.$$.fragment)},l(n){N(e.$$.fragment,n)},m(n,i){Q(e,n,i),a=!0},p(n,i){const s={};i&4&&(s.updateState=n[2]),i&8&&(s.openCard=n[3]),i&1&&(s.state=n[0]),i&2&&(s.placeId=n[1]),e.$set(s)},i(n){a||(E(e.$$.fragment,n),a=!0)},o(n){V(e.$$.fragment,n),a=!1},d(n){R(e,n)}}}function Xe(t){let e,a,n,i,s,r=t[4].length&&Ie(t);return{c(){e=$("div"),r&&r.c(),this.h()},l(d){e=j(d,"DIV",{id:!0,class:!0,draggable:!0});var k=M(e);r&&r.l(k),k.forEach(D),this.h()},h(){C(e,"id",a=`place--${t[1]}`),C(e,"class","dropzone svelte-17g3a1o"),C(e,"draggable","false")},m(d,k){B(d,e,k),r&&r.m(e,null),n=!0,i||(s=[A(e,"dragover",re(t[5])),A(e,"dragleave",t[6]),A(e,"drop",t[7])],i=!0)},p(d,[k]){d[4].length?r?(r.p(d,k),k&16&&E(r,1)):(r=Ie(d),r.c(),E(r,1),r.m(e,null)):r&&(Z(),V(r,1,1,()=>{r=null}),G()),(!n||k&2&&a!==(a=`place--${d[1]}`))&&C(e,"id",a)},i(d){n||(E(r),n=!0)},o(d){V(r),n=!1},d(d){d&&D(e),r&&r.d(),i=!1,le(s)}}}function Ye(t,e,a){let n,{state:i}=e,{placeId:s}=e,{updateState:r}=e,{openCard:d}=e,k;te.subscribe(v=>{k=v});function o(){return n.length}function l(v){o()||!W(k,s,i)||_e(v.target)}function f(v){x(v.target)}function b(v){var I;if(o()||!W(k,s,i))return;x(v.target);const w=(I=v.dataTransfer)==null?void 0:I.getData("text/plain"),m=JSON.parse(w),_=v.target.closest(".dropzone"),y=me(_==null?void 0:_.id);r(y,m.placeId,m.cardIndex)}return t.$$set=v=>{"state"in v&&a(0,i=v.state),"placeId"in v&&a(1,s=v.placeId),"updateState"in v&&a(2,r=v.updateState),"openCard"in v&&a(3,d=v.openCard)},t.$$.update=()=>{t.$$.dirty&3&&a(4,n=i[s])},[i,s,r,d,n,l,f,b]}class Ze extends U{constructor(e){super(),X(this,e,Ye,Xe,H,{state:0,placeId:1,updateState:2,openCard:3})}}function Ge(t){let e,a='<div id="stock-circle" class="stock-circle svelte-1mbkf8"></div>',n,i;return{c(){e=$("div"),e.innerHTML=a,this.h()},l(s){e=j(s,"DIV",{class:!0,"data-svelte-h":!0}),Be(e)!=="svelte-6hkhw2"&&(e.innerHTML=a),this.h()},h(){C(e,"class","place svelte-1mbkf8")},m(s,r){B(s,e,r),n||(i=A(e,"click",t[0]),n=!0)},p:se,i:se,o:se,d(s){s&&D(e),n=!1,i()}}}function We(t){function e(a){Ke.call(this,t,a)}return[e]}class xe extends U{constructor(e){super(),X(this,e,We,Ge,H,{})}}function we(t,e,a){const n=t.slice();return n[6]=e[a],n[8]=a,n}function Ce(t,e){let a,n,i,s,r,d,k;return n=new oe({props:{updateState:e[1],openCard:e[0],state:e[2],placeId:"talon",cardIndex:e[8]}}),{key:t,first:null,c(){a=$("div"),J(n.$$.fragment),i=q(),this.h()},l(o){a=j(o,"DIV",{class:!0,style:!0});var l=M(a);N(n.$$.fragment,l),i=L(l),l.forEach(D),this.h()},h(){C(a,"class","card-container svelte-1vgmtea"),C(a,"style",s=`${e[4](e[6],e[8])} ${De(e[6])}`),Y(a,"open",e[6].isOpen),this.first=a},m(o,l){B(o,a,l),Q(n,a,null),T(a,i),r=!0,d||(k=A(a,"click",tt),d=!0)},p(o,l){e=o;const f={};l&2&&(f.updateState=e[1]),l&1&&(f.openCard=e[0]),l&4&&(f.state=e[2]),l&8&&(f.cardIndex=e[8]),n.$set(f),(!r||l&8&&s!==(s=`${e[4](e[6],e[8])} ${De(e[6])}`))&&C(a,"style",s),(!r||l&8)&&Y(a,"open",e[6].isOpen)},i(o){r||(E(n.$$.fragment,o),r=!0)},o(o){V(n.$$.fragment,o),r=!1},d(o){o&&D(a),R(n),d=!1,k()}}}function et(t){let e,a,n,i=[],s=new Map,r;a=new xe({}),a.$on("click",t[5]);let d=F(t[3]);const k=o=>o[6].id;for(let o=0;o<d.length;o+=1){let l=we(t,d,o),f=k(l);s.set(f,i[o]=Ce(f,l))}return{c(){e=$("div"),J(a.$$.fragment),n=q();for(let o=0;o<i.length;o+=1)i[o].c();this.h()},l(o){e=j(o,"DIV",{class:!0});var l=M(e);N(a.$$.fragment,l),n=L(l);for(let f=0;f<i.length;f+=1)i[f].l(l);l.forEach(D),this.h()},h(){C(e,"class","stock svelte-1vgmtea")},m(o,l){B(o,e,l),Q(a,e,null),T(e,n);for(let f=0;f<i.length;f+=1)i[f]&&i[f].m(e,null);r=!0},p(o,[l]){l&31&&(d=F(o[3]),Z(),i=pe(i,l,k,1,o,d,s,e,fe,Ce,null,we),G())},i(o){if(!r){E(a.$$.fragment,o);for(let l=0;l<d.length;l+=1)E(i[l]);r=!0}},o(o){V(a.$$.fragment,o);for(let l=0;l<i.length;l+=1)V(i[l]);r=!1},d(o){o&&D(e),R(a);for(let l=0;l<i.length;l+=1)i[l].d()}}}function De(t){return t.isOpen?"transform: translateX(140px);":""}const tt=()=>{};function nt(t,e,a){let n,{openCard:i}=e,{updateState:s}=e,{state:r}=e;function d(o,l){return o.isOpen?`z-index: ${n.length-l};`:""}function k(){n.forEach((o,l)=>{setTimeout(()=>{o.isOpen=!1,a(3,n),a(2,r)},800/n.length*l)})}return t.$$set=o=>{"openCard"in o&&a(0,i=o.openCard),"updateState"in o&&a(1,s=o.updateState),"state"in o&&a(2,r=o.state)},t.$$.update=()=>{t.$$.dirty&4&&a(3,n=r.talon)},[i,s,r,n,d,k]}class at extends U{constructor(e){super(),X(this,e,nt,et,H,{openCard:0,updateState:1,state:2})}}function Ee(t,e,a){const n=t.slice();return n[7]=e[a],n[9]=a,n}function Te(t){let e,a;return e=new oe({props:{state:t[0],placeId:t[1],cardIndex:t[9],updateState:t[2],openCard:it}}),{c(){J(e.$$.fragment)},l(n){N(e.$$.fragment,n)},m(n,i){Q(e,n,i),a=!0},p(n,i){const s={};i&1&&(s.state=n[0]),i&2&&(s.placeId=n[1]),i&4&&(s.updateState=n[2]),e.$set(s)},i(n){a||(E(e.$$.fragment,n),a=!0)},o(n){V(e.$$.fragment,n),a=!1},d(n){R(e,n)}}}function st(t){let e,a,n,i,s,r=F(t[0][t[1]]),d=[];for(let o=0;o<r.length;o+=1)d[o]=Te(Ee(t,r,o));const k=o=>V(d[o],1,1,()=>{d[o]=null});return{c(){e=$("div");for(let o=0;o<d.length;o+=1)d[o].c();this.h()},l(o){e=j(o,"DIV",{id:!0,class:!0,draggable:!0});var l=M(e);for(let f=0;f<d.length;f+=1)d[f].l(l);l.forEach(D),this.h()},h(){C(e,"id",a=`foundation--${t[1]}`),C(e,"class","dropzone svelte-1uwjn3s"),C(e,"draggable","false")},m(o,l){B(o,e,l);for(let f=0;f<d.length;f+=1)d[f]&&d[f].m(e,null);n=!0,i||(s=[A(e,"dragover",re(t[3])),A(e,"dragleave",t[4]),A(e,"drop",t[5])],i=!0)},p(o,[l]){if(l&7){r=F(o[0][o[1]]);let f;for(f=0;f<r.length;f+=1){const b=Ee(o,r,f);d[f]?(d[f].p(b,l),E(d[f],1)):(d[f]=Te(b),d[f].c(),E(d[f],1),d[f].m(e,null))}for(Z(),f=r.length;f<d.length;f+=1)k(f);G()}(!n||l&2&&a!==(a=`foundation--${o[1]}`))&&C(e,"id",a)},i(o){if(!n){for(let l=0;l<r.length;l+=1)E(d[l]);n=!0}},o(o){d=d.filter(Boolean);for(let l=0;l<d.length;l+=1)V(d[l]);n=!1},d(o){o&&D(e),Je(d,o),i=!1,le(s)}}}const it=()=>{};function lt(t,e,a){let{state:n}=e,{placeId:i}=e,{updateState:s}=e,r;te.subscribe(l=>{r=l});function d(l){W(r,i,n)&&_e(l.target)}function k(l){x(l.target)}function o(l){var m;if(!W(r,i,n))return;x(l.target);const f=(m=l.dataTransfer)==null?void 0:m.getData("text/plain"),b=JSON.parse(f),v=l.target.closest(".dropzone"),w=me(v==null?void 0:v.id);s(w,b.placeId,b.cardIndex)}return t.$$set=l=>{"state"in l&&a(0,n=l.state),"placeId"in l&&a(1,i=l.placeId),"updateState"in l&&a(2,s=l.updateState)},[n,i,s,d,k,o]}class rt extends U{constructor(e){super(),X(this,e,lt,st,H,{state:0,placeId:1,updateState:2})}}const{window:ot}=Qe;function Ve(t,e,a){const n=t.slice();return n[13]=e[a],n}function $e(t,e,a){const n=t.slice();return n[13]=e[a],n}function je(t,e){let a,n,i;return n=new rt({props:{state:e[0],placeId:e[13],updateState:e[1]}}),{key:t,first:null,c(){a=ie(),J(n.$$.fragment),this.h()},l(s){a=ie(),N(n.$$.fragment,s),this.h()},h(){this.first=a},m(s,r){B(s,a,r),Q(n,s,r),i=!0},p(s,r){e=s;const d={};r&1&&(d.state=e[0]),n.$set(d)},i(s){i||(E(n.$$.fragment,s),i=!0)},o(s){V(n.$$.fragment,s),i=!1},d(s){s&&D(a),R(n,s)}}}function Me(t,e){let a,n,i;return n=new Ze({props:{state:e[0],placeId:e[13],updateState:e[1],openCard:e[2]}}),{key:t,first:null,c(){a=ie(),J(n.$$.fragment),this.h()},l(s){a=ie(),N(n.$$.fragment,s),this.h()},h(){this.first=a},m(s,r){B(s,a,r),Q(n,s,r),i=!0},p(s,r){e=s;const d={};r&1&&(d.state=e[0]),n.$set(d)},i(s){i||(E(n.$$.fragment,s),i=!0)},o(s){V(n.$$.fragment,s),i=!1},d(s){s&&D(a),R(n,s)}}}function ut(t){let e,a,n,i,s,r=[],d=new Map,k,o,l=[],f=new Map,b,v,w;n=new at({props:{state:t[0],updateState:t[1],openCard:t[2]}});let m=F(["foundation-1","foundation-2","foundation-3","foundation-4"]);const _=p=>p[13];for(let p=0;p<4;p+=1){let u=$e(t,m,p),c=_(u);d.set(c,r[p]=je(c,u))}let y=F(["pile-1","pile-2","pile-3","pile-4","pile-5","pile-6","pile-7"]);const I=p=>p[13];for(let p=0;p<7;p+=1){let u=Ve(t,y,p),c=I(u);f.set(c,l[p]=Me(c,u))}return{c(){e=$("section"),a=$("div"),J(n.$$.fragment),i=q(),s=$("div");for(let p=0;p<4;p+=1)r[p].c();k=q(),o=$("div");for(let p=0;p<7;p+=1)l[p].c();this.h()},l(p){e=j(p,"SECTION",{class:!0});var u=M(e);a=j(u,"DIV",{class:!0});var c=M(a);N(n.$$.fragment,c),i=L(c),s=j(c,"DIV",{class:!0});var S=M(s);for(let h=0;h<4;h+=1)r[h].l(S);S.forEach(D),c.forEach(D),k=L(u),o=j(u,"DIV",{class:!0});var g=M(o);for(let h=0;h<7;h+=1)l[h].l(g);g.forEach(D),u.forEach(D),this.h()},h(){C(s,"class","foundation-list svelte-1shyztj"),C(a,"class","row svelte-1shyztj"),C(o,"class","row svelte-1shyztj"),C(e,"class","table svelte-1shyztj")},m(p,u){B(p,e,u),T(e,a),Q(n,a,null),T(a,i),T(a,s);for(let c=0;c<4;c+=1)r[c]&&r[c].m(s,null);T(e,k),T(e,o);for(let c=0;c<7;c+=1)l[c]&&l[c].m(o,null);b=!0,v||(w=A(ot,"contextmenu",re(t[3])),v=!0)},p(p,[u]){const c={};u&1&&(c.state=p[0]),n.$set(c),u&3&&(m=F(["foundation-1","foundation-2","foundation-3","foundation-4"]),Z(),r=pe(r,u,_,1,p,m,d,s,fe,je,null,$e),G()),u&7&&(y=F(["pile-1","pile-2","pile-3","pile-4","pile-5","pile-6","pile-7"]),Z(),l=pe(l,u,I,1,p,y,f,o,fe,Me,null,Ve),G())},i(p){if(!b){E(n.$$.fragment,p);for(let u=0;u<4;u+=1)E(r[u]);for(let u=0;u<7;u+=1)E(l[u]);b=!0}},o(p){V(n.$$.fragment,p);for(let u=0;u<4;u+=1)V(r[u]);for(let u=0;u<7;u+=1)V(l[u]);b=!1},d(p){p&&D(e),R(n);for(let u=0;u<4;u+=1)r[u].d();for(let u=0;u<7;u+=1)l[u].d();v=!1,w()}}}function Ae(t,e,a,n,i=!1){let s;const r={...t};return a==="talon"?s=r[a].splice(+n,1):s=r[a].splice(+n),r[e].push(...s),r}function dt(t,e,a){let n=!1,i="иван",s=Le;ze(()=>{var _;o();const m=new URLSearchParams(window.location.search);n=!!m.get("secret-ending"),m.get("player")&&(i=(_=m.get("player"))==null?void 0:_.split("").splice(0,4).join(""))});function r(m,_,y,I=!1){var u;let p;_==="talon"?p=s[_].splice(+y,1):p=s[_].splice(+y),s[m].push(...p),_.includes("pile")&&s[_].length>0&&(s[_].at(-1).isOpen=!0),a(0,s),I&&((u=document.getElementById(`foundation--${m}`))==null||u.children),setTimeout(()=>{d()})}function d(){s["foundation-1"].length===13&&s["foundation-2"].length===13&&s["foundation-3"].length===13&&s["foundation-4"].length===13&&(v(),n&&setTimeout(w,200*54))}function k(m,_){s[m][_].isOpen||(a(0,s[m][_].isOpen=!0,s),a(0,s))}function o(){const m=Fe(qe);for(let _=0;_<7;_++){const y=`pile-${_+1}`;a(0,s[y]=m.splice(0,_+1),s),s[y].at(-1).isOpen=!0}a(0,s.talon=m,s)}function l(){for(const m of["pile-1","pile-2","pile-3","pile-4","pile-5","pile-6","pile-7"])s[m].at(-1)&&s[m].at(-1).isOpen===!1&&(s[m].at(-1).isOpen=!0)}function f(){let m=!1,_={...s},y={..._};const I=[];for(;!m;)_=b(s,I),_&&(y=_),_===void 0&&(m=!0);I.forEach(({el:p,target:u},c)=>{ge(p,u)}),l(),setTimeout(()=>{a(0,s=y),setTimeout(d)},he)}function b(m,_=[]){for(const y of["foundation-1","foundation-2","foundation-3","foundation-4"]){const I=m[y];if(I.length===0)for(const p of["talon","pile-1","pile-2","pile-3","pile-4","pile-5","pile-6","pile-7"]){const u=m[p],c=p==="talon"?u.filter(g=>g.isOpen).at(0):u.at(-1),S=u.indexOf(c);if(c&&c.isOpen&&u.length>0&&z(c)===1){const g=document.querySelector(`[id$=${c.id}`),h=document.getElementById(`foundation--${y}`);return _.push({el:g,target:h}),Ae(m,y,p,S)}}else{const p=I.at(-1);for(const u of["talon","pile-1","pile-2","pile-3","pile-4","pile-5","pile-6","pile-7"]){const c=m[u],S=u==="talon"?c.filter(h=>h.isOpen).at(0):c.at(-1),g=c.indexOf(S);if(S&&S.isOpen&&c.length>0&&S.suit===p.suit&&z(S)===z(p)+1){const h=document.querySelector(`[id$=${S.id}`),O=document.getElementById(`foundation--${y}`);return _.push({el:h,target:O}),Ae(m,y,u,g)}}}}}function v(){let m=0;for(let _=12;_>=0;_--)for(const y of["foundation-1","foundation-2","foundation-3","foundation-4"]){const I=document.querySelectorAll(`#foundation--${y} > div`)[_],p=I.querySelector(".card-back"),u=I.querySelector(".card-face");setTimeout(()=>{const c=`${ee(15,25)/10}s`,S=Math.random()<.5?"-":"",g=Math.random()<.5?"-":"",h=Math.random()<.5?"-":"";I.style.transition=c,p.style.transition=c,u.style.transition=c,p.style.opacity="0",u.style.opacity="0",I.style.transform=`scale(${ee(4,6)}) rotateZ(${h}${ee(270,540)}deg) rotateX(${S}${ee(270,540)}deg) rotateY(${g}${ee(270,540)}deg)`,I.style.transformStyle="preserve-3d"},200*m),m++}}function w(){const m=["foundation--foundation-1","foundation--foundation-2","foundation--foundation-3","foundation--foundation-4","place--pile-1","place--pile-2","place--pile-3","place--pile-4","place--pile-5","place--pile-6","place--pile-7"],_=`${i}япосрал`.split("");m.forEach((I,p)=>{const u=document.createElement("div");u.style.position="absolute",u.style.top="50%",u.style.left="50%",u.style.transform="translate(-50%, -50%)",u.style.fontSize="4rem",u.style.color="#ddd",u.style.textTransform="uppercase",u.style.opacity="0",u.style.transition="opacity .8s ease-in-out",u.appendChild(document.createTextNode(_[p])),document.getElementById(I).appendChild(u),setTimeout(()=>{u.style.opacity="1"},200*p)});const y=document.createElement("img");y.src="/src/static/pesik.png",y.style.maxHeight="100%",y.style.marginTop="80px",y.style.transition="1s",document.getElementById("stock-circle").appendChild(y),setTimeout(()=>{y.style.marginTop="0px"},200*11)}return[s,r,k,f]}class ct extends U{constructor(e){super(),X(this,e,dt,ut,H,{})}}function ft(t){let e,a,n;return a=new ct({}),{c(){e=$("div"),J(a.$$.fragment),this.h()},l(i){e=j(i,"DIV",{class:!0});var s=M(e);N(a.$$.fragment,s),s.forEach(D),this.h()},h(){C(e,"class","container")},m(i,s){B(i,e,s),Q(a,e,null),n=!0},p:se,i(i){n||(E(a.$$.fragment,i),n=!0)},o(i){V(a.$$.fragment,i),n=!1},d(i){i&&D(e),R(a)}}}class _t extends U{constructor(e){super(),X(this,e,null,ft,H,{})}}export{_t as component,mt as universal};
